<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>安全 | Vue CLI Plugin Electron Builder</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="shortcut icon" href="/vue-cli-plugin-electron-builder/favicon.ico">
    <script src="/vue-cli-plugin-electron-builder/scripts/scrollToHash.js"></script>
    <meta name="description" content="轻松将您的 Vue.js 应用程序构建为 Electron 桌面应用程序。">
    <meta name="google-site-verification" content="It9QDm7l8m-gYoVuBFVzERjx0MapaegfY1AMru9wFCc">
    
    <link rel="preload" href="/vue-cli-plugin-electron-builder/assets/css/0.styles.3e5469df.css" as="style"><link rel="preload" href="/vue-cli-plugin-electron-builder/assets/js/app.2f5193cd.js" as="script"><link rel="preload" href="/vue-cli-plugin-electron-builder/assets/js/2.4f21a054.js" as="script"><link rel="preload" href="/vue-cli-plugin-electron-builder/assets/js/23.b4c703d6.js" as="script"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/10.340d9983.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/11.91ee9a2c.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/12.5a108a0d.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/13.929a568c.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/14.751f21c7.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/15.b51d2ff8.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/16.4503c806.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/17.8ca99638.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/18.c45dc42b.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/19.436e3b51.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/20.0590cf41.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/21.db939ef3.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/22.ab3a08e5.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/24.3339b3e8.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/3.03974a87.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/4.32903275.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/5.890682d4.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/6.a695b94f.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/7.59ef6029.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/8.13d4e655.js"><link rel="prefetch" href="/vue-cli-plugin-electron-builder/assets/js/9.88d6c183.js">
    <link rel="stylesheet" href="/vue-cli-plugin-electron-builder/assets/css/0.styles.3e5469df.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vue-cli-plugin-electron-builder/zh/" class="home-link router-link-active"><!----> <span class="site-name">Vue CLI Plugin Electron Builder</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vue-cli-plugin-electron-builder/zh/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/vue-cli-plugin-electron-builder/zh/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="https://github.com/nklayman/vue-cli-plugin-electron-builder/tree/v1" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/nklayman/vue-cli-plugin-electron-builder/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  变更日志
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/sponsors/nklayman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  赞助
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-cli-plugin-electron-builder/guide/security.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/vue-cli-plugin-electron-builder/zh/guide/security.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vue-cli-plugin-electron-builder/zh/" class="nav-link">
  主页
</a></div><div class="nav-item"><a href="/vue-cli-plugin-electron-builder/zh/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="https://github.com/nklayman/vue-cli-plugin-electron-builder/tree/v1" target="_blank" rel="noopener noreferrer" class="nav-link external">
  v1.x
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/nklayman/vue-cli-plugin-electron-builder/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  变更日志
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/sponsors/nklayman" target="_blank" rel="noopener noreferrer" class="nav-link external">
  赞助
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-cli-plugin-electron-builder/guide/security.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/vue-cli-plugin-electron-builder/zh/guide/security.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vue-cli-plugin-electron-builder/zh/guide/" aria-current="page" class="sidebar-link">快速开始</a></li><li><a href="/vue-cli-plugin-electron-builder/zh/guide/guide.html" class="sidebar-link">指南</a></li><li><a href="/vue-cli-plugin-electron-builder/zh/guide/configuration.html" class="sidebar-link">配置</a></li><li><a href="/vue-cli-plugin-electron-builder/zh/guide/recipes.html" class="sidebar-link">Recipes 使用技巧</a></li><li><a href="/vue-cli-plugin-electron-builder/zh/guide/security.html" aria-current="page" class="active sidebar-link">安全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue-cli-plugin-electron-builder/zh/guide/security.html#node-integration" class="sidebar-link">Node Integration</a></li><li class="sidebar-sub-header"><a href="/vue-cli-plugin-electron-builder/zh/guide/security.html#加载本地图像-资源" class="sidebar-link">加载本地图像/资源</a></li></ul></li><li><a href="/vue-cli-plugin-electron-builder/zh/guide/testingAndDebugging.html" class="sidebar-link">测试和调试</a></li><li><a href="/vue-cli-plugin-electron-builder/zh/guide/commonIssues.html" class="sidebar-link">常见问题</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="安全"><a href="#安全" class="header-anchor">#</a> 安全</h1> <p></p><div class="table-of-contents"><ul><li><a href="#node-integration">Node Integration</a></li><li><a href="#加载本地图像-资源">加载本地图像/资源</a></li></ul></div><p></p> <h2 id="node-integration"><a href="#node-integration" class="header-anchor">#</a> Node Integration</h2> <p>从 VCPEB 的 v2.0 开始，默认情况下禁用 Electron <code>nodeIntegration</code> 。这会阻止所有 node APIs ，例如 <code>require</code>. 这降低了 <a href="https://electronjs.org/docs/tutorial/security#2-do-not-enable-nodejs-integration-for-remote-content" target="_blank" rel="noopener noreferrer">安全风险<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，并且是 Electron 团队推荐的最佳实践。如果你需要在渲染器进程中使用诸如 <code>fs</code> 或 <code>sqlite</code> 之类的原生模块，你可以在 <code>vue.config.js</code> 中启用 <code>nodeIntegration</code>:</p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  pluginOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
    electronBuilder<span class="token operator">:</span> <span class="token punctuation">{</span>
      nodeIntegration<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">IPC Without Node Integration</p> <p>您仍然可以在不启用 <code>nodeIntegration</code> (译者: 也不启用 <code>contextIsolation</code> ) 情况下，使用 <a href="https://www.electronjs.org/docs/api/ipc-renderer" target="_blank" rel="noopener noreferrer">IPC<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。 只需使用以下代码创建一个<a href="/vue-cli-plugin-electron-builder/zh/guide/guide.html#preload-files">预加载脚本</a>:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ipcRenderer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'electron'</span>
window<span class="token punctuation">.</span>ipcRenderer <span class="token operator">=</span> ipcRenderer
</code></pre></div><p>现在，您可以在你的 Vue app 中使用 <code>window.ipcRenderer</code> 访问 <code>ipcRenderer</code>。</p> <p>如果你想使用 IPC without <code>nodeIntegration</code> and with <code>contextIsolation</code>, ，请使用以下代码:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> contextBridge<span class="token punctuation">,</span> ipcRenderer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'electron'</span>

<span class="token comment">// 公开受保护的方法，允许渲染器进程在不公开整个对象的情况下使用 ipcRenderer</span>
contextBridge<span class="token punctuation">.</span><span class="token function">exposeInMainWorld</span><span class="token punctuation">(</span><span class="token string">'ipcRenderer'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">send</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">channel<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// whitelist channels 白名单频道</span>
    <span class="token keyword">let</span> validChannels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'toMain'</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>validChannels<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ipcRenderer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">receive</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">channel<span class="token punctuation">,</span> func</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> validChannels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'fromMain'</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>validChannels<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Deliberately strip event as it includes `sender`</span>
      <span class="token comment">// 故意删除 event 参数，因为他包含 `sender` 方法</span>
      ipcRenderer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>然后，您可以在渲染器进程中使用 <code>window.ipcRenderer.(send/receive)</code>。</p> <p>(来自<a href="https://stackoverflow.com/questions/55164360/with-contextisolation-true-is-it-possible-to-use-ipcrenderer/59675116#59675116" target="_blank" rel="noopener noreferrer">this StackOverflow answer<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的解决方案)</p></div> <h2 id="加载本地图像-资源"><a href="#加载本地图像-资源" class="header-anchor">#</a> 加载本地图像/资源</h2> <p>如果启用了 WebSecurity ，您将无法从文件系统加载资源，即 <code>&lt;img src=&quot;file:///path/to/some/image.png&quot;/&gt;</code>。 但是，您仍然可以从 <code>public</code> 文件夹加载图像和其他资源，请参阅 <a href="/vue-cli-plugin-electron-builder/zh/guide/guide.html#处理静态资源">处理静态资源</a>。如果您需要从公共文件夹外部加载资源，则必须禁用 WebSecurity 或使用自定义协议。 <a href="https://www.electronjs.org/docs/tutorial/security#5-do-not-disable-websecurity" target="_blank" rel="noopener noreferrer">强烈建议不要禁用 WebSecurity<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，因此您应该改为使用以下技术来加载本地资源并保持启用 WebSecurity。</p> <p>将以下内容添加到您的主进程文件 (默认是<code>background.(js|ts)</code>) 中:</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'ready'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">registerLocalResourceProtocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">registerLocalResourceProtocol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  protocol<span class="token punctuation">.</span><span class="token function">registerFileProtocol</span><span class="token punctuation">(</span><span class="token string">'local-resource'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> url <span class="token operator">=</span> request<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^local-resource:\/\/</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token comment">// Decode URL to prevent errors when loading filenames with UTF-8 chars or chars like &quot;#&quot;</span>
    <span class="token keyword">const</span> decodedUrl <span class="token operator">=</span> <span class="token function">decodeURI</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span> <span class="token comment">// Needed in case URL contains spaces</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">callback</span><span class="token punctuation">(</span>decodedUrl<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'ERROR: registerLocalResourceProtocol: Could not get file path:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后，只需在本地图像 url 前加上 <code>local-resource://</code>，即 <code>&lt;img src=&quot;local-resource://image.png&quot;/&gt;</code></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vue-cli-plugin-electron-builder/zh/guide/recipes.html" class="prev">
        Recipes 使用技巧
      </a></span> <span class="next"><a href="/vue-cli-plugin-electron-builder/zh/guide/testingAndDebugging.html">
        测试和调试
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vue-cli-plugin-electron-builder/assets/js/app.2f5193cd.js" defer></script><script src="/vue-cli-plugin-electron-builder/assets/js/2.4f21a054.js" defer></script><script src="/vue-cli-plugin-electron-builder/assets/js/23.b4c703d6.js" defer></script>
  </body>
</html>
